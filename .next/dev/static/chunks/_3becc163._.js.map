{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/adhekeeloho/payment-admin-dashboard/src/lib/api.ts"],"sourcesContent":["type HttpMethod = 'GET' | 'POST' | 'PATCH' | 'PUT' | 'DELETE';\n\ntype ApiOptions = {\n  method?: HttpMethod;\n  body?: unknown;\n  token?: string | null;\n};\n\nconst normalizeBaseUrl = () => {\n  const raw = process.env.NEXT_PUBLIC_API_BASE?.replace(/\\/$/, '');\n  if (raw) {\n    return raw.endsWith('/api') ? raw : `${raw}/api`;\n  }\n  return 'https://payment-admin-dashboard-backend.vercel.app/api';\n};\n\nexport const API_BASE_URL = normalizeBaseUrl();\n\nexport const apiFetch = async <T>(path: string, options: ApiOptions = {}) => {\n  const { method = 'GET', body, token } = options;\n  const headers: Record<string, string> = {\n    'Content-Type': 'application/json',\n  };\n\n  if (token) {\n    headers.Authorization = `Bearer ${token}`;\n  }\n\n  const response = await fetch(`${API_BASE_URL}${path}`, {\n    method,\n    headers,\n    body: body ? JSON.stringify(body) : undefined,\n  });\n\n  if (!response.ok) {\n    const text = await response.text();\n    throw new Error(text || 'Request failed');\n  }\n\n  if (response.status === 204) {\n    return null as T;\n  }\n\n  return (await response.json()) as T;\n};\n\nexport const getStoredSession = () => {\n  if (typeof window === 'undefined') {\n    return null;\n  }\n  const raw = localStorage.getItem('payflow-auth');\n  if (!raw) {\n    return null;\n  }\n  try {\n    return JSON.parse(raw) as {\n      accessToken?: string;\n      refreshToken?: string;\n      role?: string;\n      email?: string;\n      expiresAt?: number;\n    };\n  } catch {\n    return null;\n  }\n};\n"],"names":[],"mappings":";;;;;;;;AASc;AADd,MAAM,mBAAmB;IACvB,MAAM,8FAAwC,QAAQ,OAAO;IAC7D,IAAI,KAAK;QACP,OAAO,IAAI,QAAQ,CAAC,UAAU,MAAM,GAAG,IAAI,IAAI,CAAC;IAClD;IACA,OAAO;AACT;AAEO,MAAM,eAAe;AAErB,MAAM,WAAW,OAAU,MAAc,UAAsB,CAAC,CAAC;IACtE,MAAM,EAAE,SAAS,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG;IACxC,MAAM,UAAkC;QACtC,gBAAgB;IAClB;IAEA,IAAI,OAAO;QACT,QAAQ,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;IAC3C;IAEA,MAAM,WAAW,MAAM,MAAM,GAAG,eAAe,MAAM,EAAE;QACrD;QACA;QACA,MAAM,OAAO,KAAK,SAAS,CAAC,QAAQ;IACtC;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,IAAI,MAAM,QAAQ;IAC1B;IAEA,IAAI,SAAS,MAAM,KAAK,KAAK;QAC3B,OAAO;IACT;IAEA,OAAQ,MAAM,SAAS,IAAI;AAC7B;AAEO,MAAM,mBAAmB;IAC9B;;IAGA,MAAM,MAAM,aAAa,OAAO,CAAC;IACjC,IAAI,CAAC,KAAK;QACR,OAAO;IACT;IACA,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IAOpB,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///Users/adhekeeloho/payment-admin-dashboard/src/components/auth/auth-form.tsx"],"sourcesContent":["'use client';\n\nimport { useRouter } from 'next/navigation';\nimport { useState } from 'react';\nimport { apiFetch } from '@/lib/api';\n\ntype AuthMode = 'login' | 'signup';\ntype UserRole = 'admin' | 'super-admin';\n\ntype AuthFormProps = {\n  mode: AuthMode;\n};\n\nconst SESSION_DURATION_MS = 1 * 60 * 1000;\n\nexport default function AuthForm({ mode }: AuthFormProps) {\n  const router = useRouter();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [role, setRole] = useState<UserRole>('admin');\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n\n  const isSignup = mode === 'signup';\n\n  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    setError('');\n    setIsLoading(true);\n\n    const trimmedEmail = email.trim().toLowerCase();\n\n    if (!trimmedEmail || !password) {\n      setError('Please enter an email and password.');\n      setIsLoading(false);\n      return;\n    }\n\n    if (isSignup && password.length < 6) {\n      setError('Password must be at least 6 characters long.');\n      setIsLoading(false);\n      return;\n    }\n\n    if (isSignup && password !== confirmPassword) {\n      setError('Passwords do not match.');\n      setIsLoading(false);\n      return;\n    }\n\n    try {\n      if (isSignup) {\n        await apiFetch('/auth/register', {\n          method: 'POST',\n          body: {\n            email: trimmedEmail,\n            password,\n          },\n        });\n\n        // After registration, go to OTP page for account setup/verification\n        if (typeof window !== 'undefined') {\n          localStorage.setItem(\n            'payflow-pending',\n            JSON.stringify({\n              email: trimmedEmail,\n              requestedAt: new Date().toISOString(),\n              role,\n              source: 'register',\n            })\n          );\n        }\n\n        router.push('/otp');\n        setIsLoading(false);\n        return;\n      }\n\n      // Login â€” get tokens directly, no OTP step\n      const loginResponse = await apiFetch<{\n        accessToken?: string;\n        refreshToken?: string;\n        expiresIn?: number;\n      }>('/auth/login', {\n        method: 'POST',\n        body: {\n          email: trimmedEmail,\n          password,\n          role,\n        },\n      });\n\n      const expiresAt = loginResponse?.expiresIn\n        ? Date.now() + loginResponse.expiresIn * 1000\n        : Date.now() + SESSION_DURATION_MS;\n\n      if (typeof window !== 'undefined') {\n        localStorage.setItem(\n          'payflow-auth',\n          JSON.stringify({\n            email: trimmedEmail,\n            mode: 'login',\n            lastLogin: new Date().toISOString(),\n            expiresAt,\n            role,\n            accessToken: loginResponse?.accessToken ?? null,\n            refreshToken: loginResponse?.refreshToken ?? null,\n          })\n        );\n      }\n\n      router.push('/');\n    } catch (err) {\n      setError('Unable to authenticate. Please check your credentials.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <form className=\"space-y-5\" onSubmit={handleSubmit}>\n      <div className=\"space-y-2\">\n        <label className=\"text-sm font-medium text-slate-700\" htmlFor=\"email\">\n          Work email\n        </label>\n        <input\n          id=\"email\"\n          type=\"email\"\n          autoComplete=\"email\"\n          className=\"w-full rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 shadow-sm outline-none transition focus:border-slate-400 focus:ring-2 focus:ring-slate-200\"\n          placeholder=\"you@company.com\"\n          value={email}\n          onChange={(event) => setEmail(event.target.value)}\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <label className=\"text-sm font-medium text-slate-700\" htmlFor=\"password\">\n          Password\n        </label>\n        <input\n          id=\"password\"\n          type=\"password\"\n          autoComplete={isSignup ? 'new-password' : 'current-password'}\n          className=\"w-full rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 shadow-sm outline-none transition focus:border-slate-400 focus:ring-2 focus:ring-slate-200\"\n          placeholder={isSignup ? 'Create a secure password' : 'Enter your password'}\n          value={password}\n          onChange={(event) => setPassword(event.target.value)}\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <label className=\"text-sm font-medium text-slate-700\" htmlFor=\"role\">\n          Role\n        </label>\n        <select\n          id=\"role\"\n          value={role}\n          onChange={(event) => setRole(event.target.value as UserRole)}\n          className=\"w-full rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 shadow-sm outline-none transition focus:border-slate-400 focus:ring-2 focus:ring-slate-200\"\n        >\n          <option value=\"admin\">Admin</option>\n          <option value=\"super-admin\">Super Admin</option>\n        </select>\n      </div>\n\n      {isSignup ? (\n        <div className=\"space-y-2\">\n          <label\n            className=\"text-sm font-medium text-slate-700\"\n            htmlFor=\"confirmPassword\"\n          >\n            Confirm password\n          </label>\n          <input\n            id=\"confirmPassword\"\n            type=\"password\"\n            autoComplete=\"new-password\"\n            className=\"w-full rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 shadow-sm outline-none transition focus:border-slate-400 focus:ring-2 focus:ring-slate-200\"\n            placeholder=\"Re-enter your password\"\n            value={confirmPassword}\n            onChange={(event) => setConfirmPassword(event.target.value)}\n          />\n        </div>\n      ) : null}\n\n      {error ? (\n        <div className=\"rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700\">\n          {error}\n        </div>\n      ) : null}\n\n      <button\n        type=\"submit\"\n        disabled={isLoading}\n        className=\"flex w-full items-center justify-center rounded-xl bg-slate-900 px-4 py-3 text-sm font-semibold text-white shadow-sm transition hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-400\"\n      >\n        {isLoading\n          ? isSignup\n            ? 'Creating account...'\n            : 'Logging in...'\n          : isSignup\n          ? 'Create account'\n          : 'Log in'}\n      </button>\n\n      <p className=\"text-center text-sm text-slate-500\">\n        {isSignup ? 'Already have an account?' : 'New to Payflow?'}{' '}\n        <a\n          className=\"font-semibold text-slate-900 hover:underline\"\n          href={isSignup ? '/login' : '/signup'}\n        >\n          {isSignup ? 'Log in' : 'Create one'}\n        </a>\n      </p>\n    </form>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAaA,MAAM,sBAAsB,IAAI,KAAK;AAEtB,SAAS,SAAS,EAAE,IAAI,EAAiB;;IACtD,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IACvD,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAW;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,MAAM,WAAW,SAAS;IAE1B,MAAM,eAAe,OAAO;QAC1B,MAAM,cAAc;QACpB,SAAS;QACT,aAAa;QAEb,MAAM,eAAe,MAAM,IAAI,GAAG,WAAW;QAE7C,IAAI,CAAC,gBAAgB,CAAC,UAAU;YAC9B,SAAS;YACT,aAAa;YACb;QACF;QAEA,IAAI,YAAY,SAAS,MAAM,GAAG,GAAG;YACnC,SAAS;YACT,aAAa;YACb;QACF;QAEA,IAAI,YAAY,aAAa,iBAAiB;YAC5C,SAAS;YACT,aAAa;YACb;QACF;QAEA,IAAI;YACF,IAAI,UAAU;gBACZ,MAAM,IAAA,gIAAQ,EAAC,kBAAkB;oBAC/B,QAAQ;oBACR,MAAM;wBACJ,OAAO;wBACP;oBACF;gBACF;gBAEA,oEAAoE;gBACpE,wCAAmC;oBACjC,aAAa,OAAO,CAClB,mBACA,KAAK,SAAS,CAAC;wBACb,OAAO;wBACP,aAAa,IAAI,OAAO,WAAW;wBACnC;wBACA,QAAQ;oBACV;gBAEJ;gBAEA,OAAO,IAAI,CAAC;gBACZ,aAAa;gBACb;YACF;YAEA,2CAA2C;YAC3C,MAAM,gBAAgB,MAAM,IAAA,gIAAQ,EAIjC,eAAe;gBAChB,QAAQ;gBACR,MAAM;oBACJ,OAAO;oBACP;oBACA;gBACF;YACF;YAEA,MAAM,YAAY,eAAe,YAC7B,KAAK,GAAG,KAAK,cAAc,SAAS,GAAG,OACvC,KAAK,GAAG,KAAK;YAEjB,wCAAmC;gBACjC,aAAa,OAAO,CAClB,gBACA,KAAK,SAAS,CAAC;oBACb,OAAO;oBACP,MAAM;oBACN,WAAW,IAAI,OAAO,WAAW;oBACjC;oBACA;oBACA,aAAa,eAAe,eAAe;oBAC3C,cAAc,eAAe,gBAAgB;gBAC/C;YAEJ;YAEA,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,KAAK;YACZ,SAAS;QACX,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE,6LAAC;QAAK,WAAU;QAAY,UAAU;;0BACpC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAM,WAAU;wBAAqC,SAAQ;kCAAQ;;;;;;kCAGtE,6LAAC;wBACC,IAAG;wBACH,MAAK;wBACL,cAAa;wBACb,WAAU;wBACV,aAAY;wBACZ,OAAO;wBACP,UAAU,CAAC,QAAU,SAAS,MAAM,MAAM,CAAC,KAAK;;;;;;;;;;;;0BAIpD,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAM,WAAU;wBAAqC,SAAQ;kCAAW;;;;;;kCAGzE,6LAAC;wBACC,IAAG;wBACH,MAAK;wBACL,cAAc,WAAW,iBAAiB;wBAC1C,WAAU;wBACV,aAAa,WAAW,6BAA6B;wBACrD,OAAO;wBACP,UAAU,CAAC,QAAU,YAAY,MAAM,MAAM,CAAC,KAAK;;;;;;;;;;;;0BAIvD,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAM,WAAU;wBAAqC,SAAQ;kCAAO;;;;;;kCAGrE,6LAAC;wBACC,IAAG;wBACH,OAAO;wBACP,UAAU,CAAC,QAAU,QAAQ,MAAM,MAAM,CAAC,KAAK;wBAC/C,WAAU;;0CAEV,6LAAC;gCAAO,OAAM;0CAAQ;;;;;;0CACtB,6LAAC;gCAAO,OAAM;0CAAc;;;;;;;;;;;;;;;;;;YAI/B,yBACC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,WAAU;wBACV,SAAQ;kCACT;;;;;;kCAGD,6LAAC;wBACC,IAAG;wBACH,MAAK;wBACL,cAAa;wBACb,WAAU;wBACV,aAAY;wBACZ,OAAO;wBACP,UAAU,CAAC,QAAU,mBAAmB,MAAM,MAAM,CAAC,KAAK;;;;;;;;;;;uBAG5D;YAEH,sBACC,6LAAC;gBAAI,WAAU;0BACZ;;;;;uBAED;0BAEJ,6LAAC;gBACC,MAAK;gBACL,UAAU;gBACV,WAAU;0BAET,YACG,WACE,wBACA,kBACF,WACA,mBACA;;;;;;0BAGN,6LAAC;gBAAE,WAAU;;oBACV,WAAW,6BAA6B;oBAAmB;kCAC5D,6LAAC;wBACC,WAAU;wBACV,MAAM,WAAW,WAAW;kCAE3B,WAAW,WAAW;;;;;;;;;;;;;;;;;;AAKjC;GA3MwB;;QACP,kJAAS;;;KADF"}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///Users/adhekeeloho/payment-admin-dashboard/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}}]
}