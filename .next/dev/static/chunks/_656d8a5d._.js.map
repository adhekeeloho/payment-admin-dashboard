{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/adhekeeloho/payment-admin-dashboard/src/lib/api.ts"],"sourcesContent":["type HttpMethod = 'GET' | 'POST' | 'PATCH' | 'PUT' | 'DELETE';\n\ntype ApiOptions = {\n  method?: HttpMethod;\n  body?: unknown;\n  token?: string | null;\n};\n\nconst normalizeBaseUrl = () => {\n  const raw = process.env.NEXT_PUBLIC_API_BASE?.replace(/\\/$/, '');\n  if (raw) {\n    return raw.endsWith('/api') ? raw : `${raw}/api`;\n  }\n  return 'https://payment-admin-dashboard-backend.vercel.app/api';\n};\n\nexport const API_BASE_URL = normalizeBaseUrl();\n\nexport const apiFetch = async <T>(path: string, options: ApiOptions = {}) => {\n  const { method = 'GET', body, token } = options;\n  const headers: Record<string, string> = {\n    'Content-Type': 'application/json',\n  };\n\n  if (token) {\n    headers.Authorization = `Bearer ${token}`;\n  }\n\n  const response = await fetch(`${API_BASE_URL}${path}`, {\n    method,\n    headers,\n    body: body ? JSON.stringify(body) : undefined,\n  });\n\n  if (!response.ok) {\n    const text = await response.text();\n    throw new Error(text || 'Request failed');\n  }\n\n  if (response.status === 204) {\n    return null as T;\n  }\n\n  return (await response.json()) as T;\n};\n\nexport const getStoredSession = () => {\n  if (typeof window === 'undefined') {\n    return null;\n  }\n  const raw = localStorage.getItem('payflow-auth');\n  if (!raw) {\n    return null;\n  }\n  try {\n    return JSON.parse(raw) as {\n      accessToken?: string;\n      refreshToken?: string;\n      role?: string;\n      email?: string;\n      expiresAt?: number;\n    };\n  } catch {\n    return null;\n  }\n};\n"],"names":[],"mappings":";;;;;;;;AASc;AADd,MAAM,mBAAmB;IACvB,MAAM,8FAAwC,QAAQ,OAAO;IAC7D,IAAI,KAAK;QACP,OAAO,IAAI,QAAQ,CAAC,UAAU,MAAM,GAAG,IAAI,IAAI,CAAC;IAClD;IACA,OAAO;AACT;AAEO,MAAM,eAAe;AAErB,MAAM,WAAW,OAAU,MAAc,UAAsB,CAAC,CAAC;IACtE,MAAM,EAAE,SAAS,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG;IACxC,MAAM,UAAkC;QACtC,gBAAgB;IAClB;IAEA,IAAI,OAAO;QACT,QAAQ,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;IAC3C;IAEA,MAAM,WAAW,MAAM,MAAM,GAAG,eAAe,MAAM,EAAE;QACrD;QACA;QACA,MAAM,OAAO,KAAK,SAAS,CAAC,QAAQ;IACtC;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,IAAI,MAAM,QAAQ;IAC1B;IAEA,IAAI,SAAS,MAAM,KAAK,KAAK;QAC3B,OAAO;IACT;IAEA,OAAQ,MAAM,SAAS,IAAI;AAC7B;AAEO,MAAM,mBAAmB;IAC9B;;IAGA,MAAM,MAAM,aAAa,OAAO,CAAC;IACjC,IAAI,CAAC,KAAK;QACR,OAAO;IACT;IACA,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IAOpB,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///Users/adhekeeloho/payment-admin-dashboard/src/app/%28auth%29/otp/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { apiFetch } from '@/lib/api';\n\nconst SESSION_DURATION_MS = 1 * 60 * 1000;\n\nexport default function OtpPage() {\n  const router = useRouter();\n  const [otp, setOtp] = useState(Array.from({ length: 6 }, () => ''));\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [pendingEmail, setPendingEmail] = useState('');\n  const inputsRef = useRef<Array<HTMLInputElement | null>>([]);\n\n  useEffect(() => {\n    const pending = localStorage.getItem('payflow-pending');\n    if (!pending) {\n      router.replace('/login');\n      return;\n    }\n    try {\n      const parsed = JSON.parse(pending);\n      setPendingEmail(parsed?.email ?? '');\n    } catch {\n      // ignore\n    }\n  }, [router]);\n\n  const handleChange = (index: number, value: string) => {\n    if (!/^[0-9]?$/.test(value)) {\n      return;\n    }\n    const next = [...otp];\n    next[index] = value;\n    setOtp(next);\n\n    if (value && inputsRef.current[index + 1]) {\n      inputsRef.current[index + 1]?.focus();\n    }\n  };\n\n  const handleKeyDown = (index: number, event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key === 'Backspace' && !otp[index] && inputsRef.current[index - 1]) {\n      inputsRef.current[index - 1]?.focus();\n    }\n  };\n\n  const handleSubmit = async (event: React.FormEvent) => {\n    event.preventDefault();\n    setError('');\n    setIsLoading(true);\n\n    const code = otp.join('');\n\n    if (code.length < 6) {\n      setError('Enter the 6-digit code to continue.');\n      setIsLoading(false);\n      return;\n    }\n\n    try {\n      const pendingRaw = localStorage.getItem('payflow-pending');\n      const pending = pendingRaw ? JSON.parse(pendingRaw) : null;\n\n      const verifyResponse = await apiFetch<{\n        accessToken?: string;\n        refreshToken?: string;\n        expiresIn?: number;\n      }>('/auth/otp/verify', {\n        method: 'POST',\n        body: {\n          email: pending?.email,\n          code,\n          requestId: pending?.requestId,\n        },\n      });\n\n      const expiresAt = verifyResponse?.expiresIn\n        ? Date.now() + verifyResponse.expiresIn * 1000\n        : Date.now() + SESSION_DURATION_MS;\n\n      localStorage.setItem(\n        'payflow-auth',\n        JSON.stringify({\n          email: pending?.email,\n          mode: 'login',\n          lastLogin: new Date().toISOString(),\n          expiresAt,\n          role: pending?.role ?? 'admin',\n          accessToken: verifyResponse?.accessToken ?? null,\n          refreshToken: verifyResponse?.refreshToken ?? null,\n        })\n      );\n      localStorage.removeItem('payflow-pending');\n\n      router.push('/');\n    } catch (err) {\n      setError('OTP verification failed. Please try again.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleResend = async () => {\n    try {\n      const pendingRaw = localStorage.getItem('payflow-pending');\n      const pending = pendingRaw ? JSON.parse(pendingRaw) : null;\n      await apiFetch('/auth/otp/request', {\n        method: 'POST',\n        body: {\n          email: pending?.email,\n        },\n      });\n      setError('A new OTP was requested.');\n    } catch (err) {\n      setError('Unable to request a new OTP.');\n    }\n  };\n\n  return (\n    <div className=\"space-y-6 animate-fade-up\">\n      <div className=\"space-y-2\">\n        <p className=\"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400\">\n          Account Setup\n        </p>\n        <h1 className=\"text-2xl font-semibold text-slate-900\">Verify your email</h1>\n        <p className=\"text-sm text-slate-500\">\n          We sent a 6-digit verification code to{' '}\n          {pendingEmail ? (\n            <span className=\"font-medium text-slate-700\">{pendingEmail}</span>\n          ) : (\n            'your email address'\n          )}\n          . Enter it below to complete your registration and get started.\n        </p>\n      </div>\n\n      <form className=\"space-y-5\" onSubmit={handleSubmit}>\n        <div className=\"flex items-center gap-2\">\n          {otp.map((digit, index) => (\n            <input\n              key={index}\n              ref={(element) => {\n                inputsRef.current[index] = element;\n              }}\n              value={digit}\n              onChange={(event) => handleChange(index, event.target.value)}\n              onKeyDown={(event) => handleKeyDown(index, event)}\n              inputMode=\"numeric\"\n              maxLength={1}\n              className=\"h-12 w-12 rounded-xl border border-slate-200 bg-white text-center text-lg font-semibold text-slate-900 shadow-sm outline-none transition focus:border-slate-400\"\n            />\n          ))}\n        </div>\n\n        {error ? (\n          <div className=\"rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700\">\n            {error}\n          </div>\n        ) : null}\n\n        <button\n          type=\"submit\"\n          disabled={isLoading}\n          className=\"flex w-full items-center justify-center rounded-xl bg-slate-900 px-4 py-3 text-sm font-semibold text-white shadow-sm transition hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-400\"\n        >\n          {isLoading ? 'Verifying...' : 'Complete setup'}\n        </button>\n\n        <div className=\"flex items-center justify-between text-xs text-slate-500\">\n          <span>Did not receive a code?</span>\n          <button\n            type=\"button\"\n            className=\"font-semibold text-slate-900 hover:underline\"\n            onClick={handleResend}\n          >\n            Resend\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 324, "column": 0}, "map": {"version":3,"sources":["file:///Users/adhekeeloho/payment-admin-dashboard/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}}]
}